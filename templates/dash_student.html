<div id="student-view" class="dashboard-container hidden">
    <div class="sidebar">
        <button onclick="showSection('sec-home')" class="active">ðŸ“… Visual Schedule</button>
        <button onclick="showSection('sec-sheets')">ðŸ“š Subject Marks</button>
        <button onclick="showSection('sec-profile')">ðŸ‘¤ Official Profile</button>
    </div>

    <div class="content-area">
        
        <div id="sec-home" class="section active">
            <div class="schedule-controls">
                <h2 style="margin:0; border:none;">Weekly Timetable</h2>
                <div id="day-selector">
                    </div>
            </div>

            <div class="time-grid-container">
                <div class="time-column">
                    <div class="time-slot">08:00</div>
                    <div class="time-slot">09:00</div>
                    <div class="time-slot">10:00</div>
                    <div class="time-slot">11:00</div>
                    <div class="time-slot">12:00</div>
                    <div class="time-slot">13:00</div>
                    <div class="time-slot">14:00</div>
                    <div class="time-slot">15:00</div>
                    <div class="time-slot">16:00</div>
                    <div class="time-slot">17:00</div>
                    <div class="time-slot">18:00</div>
                </div>
                <div class="events-column" id="schedule-canvas">
                    </div>
            </div>
        </div>

        <div id="sec-sheets" class="section">
            <h2>My Subject Sheets</h2>
            <div id="sheets-container"></div>
        </div>

        <div id="sec-profile" class="section">
            <div class="profile-detail-card">
                <div class="profile-header-bg"></div>
                <div class="profile-content">
                    <div class="profile-avatar-placeholder">ðŸŽ“</div>
                    <h2 style="border:none; margin: 10px 0 5px 0;" id="p-name">Student Name</h2>
                    <div style="color:#666; margin-bottom:20px;">University Student</div>
                    
                    <hr>

                    <div class="profile-field-grid">
                        <div class="p-field"><label>Student ID Number</label><div id="p-id">-</div></div>
                        <div class="p-field"><label>Date of Birth</label><div id="p-dob">-</div></div>
                        
                        <div class="p-field"><label>Nationality</label><div id="p-nat">-</div></div>
                        <div class="p-field"><label>Place of Birth</label><div id="p-pob">-</div></div>
                        
                        <div class="p-field"><label>Current Residence</label><div id="p-addr">-</div></div>
                        <div class="p-field"><label>High School Diploma</label><div id="p-school">-</div></div>
                        
                        <div class="p-field"><label>Entrance Exam Score</label><div id="p-score">-</div></div>
                        <div class="p-field"><label>Class Group</label><div id="p-class">-</div></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
    // --- SCHEDULE LOGIC ---
    let allEvents = [];
    const DAYS = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];

    function renderSchedule(dayName) {
        // 1. Update Buttons
        const container = document.getElementById('day-selector');
        container.innerHTML = DAYS.map(d => 
            `<button class="day-btn ${d === dayName ? 'active' : ''}" onclick="renderSchedule('${d}')">${d.substring(0,3)}</button>`
        ).join('');

        // 2. Clear Canvas
        const canvas = document.getElementById('schedule-canvas');
        canvas.innerHTML = '';

        // 3. Filter Events
        const daysEvents = allEvents.filter(e => e.day === dayName);

        if(daysEvents.length === 0) {
            canvas.innerHTML = `<div style="padding:20px; color:#999; text-align:center;">No classes on ${dayName}</div>`;
            return;
        }

        // 4. Draw Blocks
        // Assumption: Grid starts at 08:00. 1 Hour = 60px.
        const START_HOUR = 8;
        const PIXELS_PER_HOUR = 60;

        daysEvents.forEach(evt => {
            let [h, m] = evt.time.split(':').map(Number);
            
            // Calculate Top Position
            // (Current Hour - Start Hour) * 60 + (Minutes)
            let topPos = ((h - START_HOUR) * PIXELS_PER_HOUR) + m;
            
            // Height (Fixed 2 hours = 120px)
            let height = 120; 

            // Calculate End Time for display
            let endH = (h + 2);
            let timeStr = `${evt.time} - ${endH}:${m.toString().padStart(2,'0')}`;

            const block = document.createElement('div');
            block.className = 'event-block';
            block.style.top = `${topPos}px`;
            block.style.height = `${height - 5}px`; // -5 for spacing
            block.innerHTML = `
                <strong style="color:var(--primary)">${evt.subject}</strong><br>
                <small>${timeStr}</small><br>
                <small style="color:#666">${evt.type} @ ${evt.location}</small>
            `;
            canvas.appendChild(block);
        });
    }

    // --- MAIN LOADER UPDATE ---
    // (This overrides the logic in your index.html just for the student part)
    function loadStudentData(data) {
        // A. Profile
        const p = data.profile;
        document.getElementById('p-name').innerText = p.name;
        document.getElementById('p-id').innerText = p.id;
        document.getElementById('p-dob').innerText = p.dob;
        document.getElementById('p-nat').innerText = p.nationality;
        document.getElementById('p-pob').innerText = p.place_of_birth; // NEW
        document.getElementById('p-addr').innerText = p.address;
        document.getElementById('p-school').innerText = p.high_school;   // NEW
        document.getElementById('p-score').innerText = p.entrance_score; // NEW
        document.getElementById('p-class').innerText = p.class;

        // B. Schedule Init
        allEvents = data.schedule;
        // Default to Monday or Today
        renderSchedule("Monday");

        // C. Subject Sheets (Existing logic)
        document.getElementById('sheets-container').innerHTML = data.transcript.map(t => `
            <div class="subject-sheet">
                <div class="sheet-header">
                    <strong>${t.subject}</strong>
                    <div style="font-size:0.8rem;">Teacher: ${t.teacher} | Credits: ${t.credits}</div>
                </div>
                <div class="sheet-body">
                    <div class="stat-box"><div>Absence</div><div class="stat-val">${t.absent}h</div></div>
                    <div class="stat-box"><div>Sem Score</div><div class="stat-val" style="color:var(--primary)">${t.sem_score}</div></div>
                </div>
                <div style="padding:15px; font-size:0.85rem; color:#666; border-top:1px solid #eee;">
                    ${t.mark_history.join(' ')}
                </div>
            </div>
        `).join('');
    }
</script>
